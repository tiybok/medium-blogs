<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Use Aggression Framework of MongoDB and Create Mapper and Reducer Program</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Use Aggression Framework of MongoDB and Create Mapper and Reducer Program</h1>
</header>
<section data-field="subtitle" class="p-summary">
Use Aggression Framework of MongoDB and Create Mapper and Reducer Program.
</section>
<section data-field="body" class="e-content">
<section name="00ea" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="135b" id="135b" class="graf graf--h3 graf--leading graf--title">Use Aggression Framework of MongoDB and Create Mapper and Reducer Program</h3><p name="8721" id="8721" class="graf graf--p graf-after--h3">Use Aggression Framework of MongoDB and Create Mapper and Reducer Program.</p><figure name="dece" id="dece" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*G-EOMh--jo1CqlH4RZQVaA.png" data-width="1280" data-height="640" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*G-EOMh--jo1CqlH4RZQVaA.png"></figure><p name="23c3" id="23c3" class="graf graf--p graf-after--figure">MongoDB is an object-oriented, simple, dynamic, and scalable NoSQL database. It is based on the NoSQL document store model. The data objects are stored as separate documents inside a collection — instead of storing the data into the columns and rows of a traditional relational database. The motivation of the MongoDB language is to implement a data store that provides high performance, high availability, and automatic scaling. MongoDB is extremely simple to install and implement. MongoDB uses JSON or BSON documents to store data. General distributions for MongoDB support Windows, Linux, Mac OS X, and Solaris.</p><div name="075c" id="075c" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://tiybok45.medium.com/mongodb-no-sql-database-dce832d51a4c" data-href="https://tiybok45.medium.com/mongodb-no-sql-database-dce832d51a4c" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://tiybok45.medium.com/mongodb-no-sql-database-dce832d51a4c"><strong class="markup--strong markup--mixtapeEmbed-strong"><em class="markup--em markup--mixtapeEmbed-em">MongoDB (No-SQL Database)</em></strong><br>MongoDB (No-SQL Database)tiybok45.medium.com</a><a href="https://tiybok45.medium.com/mongodb-no-sql-database-dce832d51a4c" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="2df27181c26614e237f24c444945811f" data-thumbnail-img-id="1*nc1EYCspMKNDwNxBG64z4A.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*nc1EYCspMKNDwNxBG64z4A.png);"></a></div><h3 name="5ac1" id="5ac1" class="graf graf--h3 graf-after--mixtapeEmbed">What is Aggregation Framework ?</h3><p name="a569" id="a569" class="graf graf--p graf-after--h3">The Aggregation framework is just a way to query documents in a collection in MongoDB. This framework exists because when you start working with and manipulating data, you often need to crunch collections together, modify them, pluck out fields, rename fields, concatinate them together, group documents by field, explode array of fields in different documents and so on.</p><p name="f481" id="f481" class="graf graf--p graf-after--p">The simple query set in MongoDB only allows you to retrieve full or parts of individual documents. They don’t really allow you to manipulate the documents on the server and then return them to your application. This is where the aggregation framework from MongoDB comes in. It’s nothing external, as aggregation comes baked into MongoDB.</p><h3 name="3bab" id="3bab" class="graf graf--h3 graf-after--p">What is Pipeline in Aggregation Framework ?</h3><p name="94fc" id="94fc" class="graf graf--p graf-after--h3">The Aggregation framework relies on the pipeline concept. The pipeline consists of certain stages where certain operators modify the documents in the collection using various techniques. Finally, the output is returned to the application calling the query.</p><p name="afa8" id="afa8" class="graf graf--p graf-after--p">In MongoDB, the pipeline is an array consisting of various operators, which take in a bunch of documents and spit out modified documents according to the rules specified by the programmer. The next operator takes in the documents spat out by the previous operator, hence, it’s called a pipeline. Some of the example of operators are $group , $match , $project, $sort etc.</p><p name="be5f" id="be5f" class="graf graf--p graf-after--p">Comparing it with the query like find() , which works in most of the cases but not handy when we want to modify and retrieve data at the same time.</p><h3 name="66d6" id="66d6" class="graf graf--h3 graf-after--p">What is Map Reduce?</h3><p name="a6ad" id="a6ad" class="graf graf--p graf-after--h3">The Map Reduce programming model comes to the rescue here. MapReduce, which was first used by Google to analyse its search results, has grown in popularity due to its ability to split and process terabytes of data in parallel, generating results faster.</p><figure name="5af0" id="5af0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*JUTnXYVeoEJ1f5yiSUae_Q.png" data-width="999" data-height="505" src="https://cdn-images-1.medium.com/max/800/1*JUTnXYVeoEJ1f5yiSUae_Q.png"></figure><p name="5132" id="5132" class="graf graf--p graf-after--figure">A (Key,value) pair is the basic unit of information in MapReduce. Before feeding the data to the MapReduce model, all types of structured and unstructured data must be translated to this basic unit. The MapReduce model, as the name implies, consists of two distinct routines: the Map-function and the Reduce-function.</p><p name="7e99" id="7e99" class="graf graf--p graf-after--p">MapReduce is a framework for handling parallelisable problems across huge files using a huge number of devices (nodes), which are collectively referred to as a cluster (if all nodes are on the same local network and use similar hardware) or a grid (if the nodes are shared across geographically and administratively distributed systems, and use more heterogeneous hardware).</p><p name="428e" id="428e" class="graf graf--p graf-after--p">When data stored in a filesystem (unstructured) or a database(structured) is processed, MapReduce can take advantage of data’s locality, processing it close to where its stored to reduce communication costs.</p><p name="eb1a" id="eb1a" class="graf graf--p graf-after--p">Typically, a MapReduce framework (or system) consists of three operations:</p><ul class="postList"><li name="b91f" id="b91f" class="graf graf--li graf-after--p">Map: Each worker node applies the map function to local data and saves the result to a temporary storage. Only one copy of the redundant input data is processed by a master node.</li><li name="0007" id="0007" class="graf graf--li graf-after--li">Shuffle: worker nodes redistribute data based on output keys (produced by the map function), ensuring that all data associated with a single key is stored on the same worker node.</li><li name="a997" id="a997" class="graf graf--li graf-after--li">Reduce: each group of output data is now processed in parallel by worker nodes, per key.</li></ul><h4 name="d65a" id="d65a" class="graf graf--h4 graf-after--li">Create a collection ‘orders’ with these documents:</h4><figure name="32e7" id="32e7" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*ISTjGqRkoXfVb2NjNHsKhw.png" data-width="1552" data-height="1802" src="https://cdn-images-1.medium.com/max/800/1*ISTjGqRkoXfVb2NjNHsKhw.png"></figure><p name="b6dd" id="b6dd" class="graf graf--p graf-after--figure">Apply a map-reduce operation to the orders collection to group them by cust_id, then add the prices for each cust_id:</p><h4 name="de8a" id="de8a" class="graf graf--h4 graf-after--p">To process each input document, define the map function:</h4><ul class="postList"><li name="4cb9" id="4cb9" class="graf graf--li graf-after--h4">this refers the document that the map-reduce operation is processing in the function.</li><li name="0ab8" id="0ab8" class="graf graf--li graf-after--li">For each document, the function maps the price to the cust_id and outputs the cust_id and price.</li></ul><pre name="19e5" id="19e5" class="graf graf--pre graf-after--li">var mapFunction1 = function() {emit(this.cust_id, this.price);};</pre><h4 name="9375" id="9375" class="graf graf--h4 graf-after--pre">With the two arguments keyCustId and valuesPrices, define the corresponding reduce function:</h4><ul class="postList"><li name="3d5e" id="3d5e" class="graf graf--li graf-after--h4">The elements of the valuesPrices array are the price values emitted by the map function, grouped by keyCustId.</li><li name="9032" id="9032" class="graf graf--li graf-after--li">The valuesPrice array is reduced to the sum of its elements by this function.</li></ul><pre name="4a52" id="4a52" class="graf graf--pre graf-after--li">var reduceFunction1 = function(keyCustId, valuesPrices) {return Array.sum(valuesPrices);};</pre><h4 name="f10d" id="f10d" class="graf graf--h4 graf-after--pre">Apply the mapFunction1 map function and the reduceFunction1 reduce function to all documents in the orders collection:</h4><pre name="f3cb" id="f3cb" class="graf graf--pre graf-after--h4">db.orders.mapReduce(mapFunction1,reduceFunction1,{ out: &quot;map_reduce_example&quot; })</pre><h4 name="f756" id="f756" class="graf graf--h4 graf-after--pre">The results of this operation are saved in the map_reduce_example collection. If the map_reduce_example collection already exists, the operation will overwrite its contents with the map-reduce operation’s results.</h4><figure name="66c4" id="66c4" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*O7FL558piLfe9QT7YVhQNg.png" data-width="1460" data-height="266" src="https://cdn-images-1.medium.com/max/800/1*O7FL558piLfe9QT7YVhQNg.png"></figure><h4 name="ef7d" id="ef7d" class="graf graf--h4 graf-after--figure">Check the map_reduce_example collection to verify:</h4><pre name="8a32" id="8a32" class="graf graf--pre graf-after--h4">db.map_reduce_example.find().sort( { _id: 1 } )</pre><figure name="f329" id="f329" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*wEPThReEyUp67xZSt3rEmw.png" data-width="1636" data-height="420" src="https://cdn-images-1.medium.com/max/800/1*wEPThReEyUp67xZSt3rEmw.png"></figure><h3 name="b7c0" id="b7c0" class="graf graf--h3 graf-after--figure">Aggregation Alternative:</h3><h4 name="93ef" id="93ef" class="graf graf--h4 graf-after--h3">You can rewrite the map-reduce operation without defining custom functions by using the available aggregation pipeline operators:</h4><pre name="2937" id="2937" class="graf graf--pre graf-after--h4">db.orders.aggregate([{$group: { _id:&quot;$cust_id&quot;,value:{$sum: &quot;$price&quot; } } },{ $out: &quot;agg_alternative_1&quot; }])</pre><h4 name="ca68" id="ca68" class="graf graf--h4 graf-after--pre">Check the agg_alternative_1 collection to verify:</h4><pre name="f36f" id="f36f" class="graf graf--pre graf-after--h4">db.agg_alternative_1.find().sort( { _id: 1 } )</pre><figure name="4f07" id="4f07" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*Y9My_U10fYv1SQoWW3VTtA.png" data-width="1454" data-height="340" src="https://cdn-images-1.medium.com/max/800/1*Y9My_U10fYv1SQoWW3VTtA.png"></figure><p name="a308" id="a308" class="graf graf--p graf-after--figure">In a similar manner, MapReduce queries can be used to construct large complex aggregation queries. The use of custom Javascript functions make use of MapReduce which is very flexible and powerful.</p><h3 name="756a" id="756a" class="graf graf--h3 graf-after--p">Conclusion</h3><p name="c3ac" id="c3ac" class="graf graf--p graf-after--h3">The reduce function is used to perform operations on the mapped data, while the map function is used to group all the data based on the key-value pair.We have studied about the MapReduce as an operation. Also, we have gone through the implementation of mapReduce() with Mongosh.When there’s a large quantum of data to find specific results from in a short amount of time, the MapReduce operation has been a reliable function to use.</p><p name="f8a0" id="f8a0" class="graf graf--p graf-after--p graf--trailing">Over time though, Google discarded MapReduce function in favour of Cloud Dataflow, and it has emerged as an alternative to MapReduce. Cloud Dataflow was invented by Google and later open sourced for performing data analytics operations across many servers, in real time.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@tiybok45" class="p-author h-card">Rutvik Bhalerao</a> on <a href="https://medium.com/p/2c3ae6fbb81f"><time class="dt-published" datetime="2022-06-12T04:16:52.532Z">June 12, 2022</time></a>.</p><p><a href="https://medium.com/@tiybok45/use-aggression-framework-of-mongodb-and-create-mapper-and-reducer-program-2c3ae6fbb81f" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 22, 2022.</p></footer></article></body></html>