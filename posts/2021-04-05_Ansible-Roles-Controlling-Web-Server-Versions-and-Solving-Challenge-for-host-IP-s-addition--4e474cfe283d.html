<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Ansible Roles Controlling Web-Server Versions and Solving Challenge for host IP’s addition…</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Ansible Roles Controlling Web-Server Versions and Solving Challenge for host IP’s addition…</h1>
</header>
<section data-field="subtitle" class="p-summary">
Ansible Roles Controlling Web-Server Versions and Solving Challenge for host IP’s addition dynamically over each Managed Node in…
</section>
<section data-field="body" class="e-content">
<section name="4081" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="d1b9" id="d1b9" class="graf graf--h3 graf--leading graf--title">Ansible Roles Controlling Web-Server Versions and Solving Challenge for host IP’s addition dynamically over each Managed Node in HAProxy.cfg file</h3><p name="eb58" id="eb58" class="graf graf--p graf-after--h3">Ansible Roles Controlling Web-Server Versions and Solving Challenge for host IP’s addition dynamically over each Managed Node in HAProxy.cfg file.</p><figure name="8be8" id="8be8" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*AxYXQ1cqqGqNLCSJmscVlQ.png" data-width="1472" data-height="810" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*AxYXQ1cqqGqNLCSJmscVlQ.png"></figure><h3 name="c568" id="c568" class="graf graf--h3 graf-after--figure">What is Ansible :</h3><p name="43f9" id="43f9" class="graf graf--p graf-after--h3">Ansible is an open-source automation tool that automates software provisioning, configuration management, and application deployment.</p><p name="87fe" id="87fe" class="graf graf--p graf-after--p">If you are a system administrator or IT engineer you probably involved in doing a lot of repetitive task in your environment whether it be sizing, creating a new house or virtual machines every day, applying configuration on them, patching hundreds of servers, migration or even performing security and compliance audits. All of these very repetitive tasks involve the execution of hundreds of commands on hundreds of different servers. Smart people develop a script to automate these tasks but it requires coding skills and regular maintenance of this script and a lot of time to put this script together in the first place. That’s where Ansible comes in the picture.</p><div name="3dae" id="3dae" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://tiybok45.medium.com/how-industries-are-solving-challenges-using-ansible-69c835962825" data-href="https://tiybok45.medium.com/how-industries-are-solving-challenges-using-ansible-69c835962825" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://tiybok45.medium.com/how-industries-are-solving-challenges-using-ansible-69c835962825"><strong class="markup--strong markup--mixtapeEmbed-strong"><em class="markup--em markup--mixtapeEmbed-em">How Industries Are Solving Challenges Using Ansible</em></strong><br>How Industries Are Solving Challenges Using Ansibletiybok45.medium.com</a><a href="https://tiybok45.medium.com/how-industries-are-solving-challenges-using-ansible-69c835962825" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="33f823e0451676f12630fca313c9d78f" data-thumbnail-img-id="1*QqN1OVK64OeM9uUf7SkSNg.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*QqN1OVK64OeM9uUf7SkSNg.png);"></a></div><figure name="a9d3" id="a9d3" class="graf graf--figure graf-after--mixtapeEmbed"><img class="graf-image" data-image-id="0*OcCctmpqJp6VPY7l.png" data-width="528" data-height="240" src="https://cdn-images-1.medium.com/max/800/0*OcCctmpqJp6VPY7l.png"></figure><h3 name="9d0b" id="9d0b" class="graf graf--h3 graf-after--figure"><em class="markup--em markup--h3-em">What is Apache Web Server:</em></h3><p name="e93f" id="e93f" class="graf graf--p graf-after--h3">Apache HTTP Server is a free and open-source web server that delivers web content through the internet. It is commonly referred to as Apache and after development, it quickly became the most popular HTTP client on the web. It’s widely thought that Apache gets its name from its development history and process of improvement through applied patches and modules but that was corrected back in 2000. It was revealed that the name originated from the respect of the Native American tribe for its resiliency and durability.</p><figure name="844e" id="844e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*r4ziR-UxoZIeQSmIx_VX1A.png" data-width="1514" data-height="724" src="https://cdn-images-1.medium.com/max/800/1*r4ziR-UxoZIeQSmIx_VX1A.png"></figure><h3 name="d7b8" id="d7b8" class="graf graf--h3 graf-after--figure"><em class="markup--em markup--h3-em">What is HAProxy :</em></h3><p name="bf54" id="bf54" class="graf graf--p graf-after--h3">HAProxy, which stands for High Availability Proxy, is a popular open source software TCP/HTTP Load Balancer and proxying solution which can be run on Linux, Solaris, and FreeBSD. Its most common use is to improve the performance and reliability of a server environment by distributing the workload across multiple servers (e.g. web, application, database). It is used in many high-profile environments, including: GitHub, Imgur, Instagram, and Twitter.</p><p name="66f2" id="66f2" class="graf graf--p graf-after--p">In this guide, we will provide a general overview of what HAProxy is, basic load-balancing terminology, and examples of how it might be used to improve the performance and reliability of your own server environment.</p><h3 name="3fdc" id="3fdc" class="graf graf--h3 graf-after--p"><strong class="markup--strong markup--h3-strong">Steps to be followed:-</strong></h3><p name="751d" id="751d" class="graf graf--p graf-after--h3">I am using <strong class="markup--strong markup--p-strong">RedHat Linux 8 </strong>on Virtual Machine for performing this task.</p><p name="d5c5" id="d5c5" class="graf graf--p graf-after--p">We use two Redhat VM, one for C<strong class="markup--strong markup--p-strong">ontroller node </strong>and other for <strong class="markup--strong markup--p-strong">Managed node or Slave node. </strong>As you can see in below image the VM of name <strong class="markup--strong markup--p-strong">Arth Ansible</strong> will be our <strong class="markup--strong markup--p-strong">Controller node</strong> and the VM of name <strong class="markup--strong markup--p-strong">Redhat 8</strong> will be our <strong class="markup--strong markup--p-strong">Managed node</strong></p><figure name="36ac" id="36ac" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*l62TMgE2ooupFhiwKKAUyQ.png" data-width="1422" data-height="1092" src="https://cdn-images-1.medium.com/max/800/1*l62TMgE2ooupFhiwKKAUyQ.png"></figure><p name="3d23" id="3d23" class="graf graf--p graf-after--figure">Before that check if python3 is intalled or not using command <strong class="markup--strong markup--p-strong">python3 -V</strong> .</p><p name="f3dd" id="f3dd" class="graf graf--p graf-after--p">Check if ansible is installed or not using command <strong class="markup--strong markup--p-strong">ansible --version</strong> and if not installed than use command <strong class="markup--strong markup--p-strong">yum install ansible</strong> to installed it.</p><p name="f8f0" id="f8f0" class="graf graf--p graf-after--p">Check Managed Node / Slave node IP address using command <strong class="markup--strong markup--p-strong">ifconfig </strong>on terminal</p><p name="5067" id="5067" class="graf graf--p graf-after--p">Setting the Slave node configuration file so that our ansible system can connect to the target node. Created the host-file which contains all this info of slave node in dir (/etc/ansible/hosts)</p><p name="f493" id="f493" class="graf graf--p graf-after--p">Creating the ansible.cfg which is configuration file for ansible and storing their our inventory.</p><p name="043b" id="043b" class="graf graf--p graf-after--p">To check our list of nodes present in our inventory file use command <strong class="markup--strong markup--p-strong">ansible all --list-hosts . </strong>Before running our ansible playbook we have to check our connection with managed node for that use command</p><p name="7ad2" id="7ad2" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">ansible all -m ping --timeout=200</strong></p><figure name="7d74" id="7d74" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*M-zbMyde0CGQd-H0gPpX-A.png" data-width="634" data-height="442" src="https://cdn-images-1.medium.com/max/800/1*M-zbMyde0CGQd-H0gPpX-A.png"></figure><p name="cbf6" id="cbf6" class="graf graf--p graf-after--figure">As you can see that there is message “ping: pong” which means our managed node is successfully connected with our controller node.</p><h3 name="d592" id="d592" class="graf graf--h3 graf-after--p">Making our workspace and writing their our yaml file.</h3><p name="1c15" id="1c15" class="graf graf--p graf-after--h3">Created a <strong class="markup--strong markup--p-strong">workspace as ws15 </strong>for our <strong class="markup--strong markup--p-strong">ansible playbook </strong>where we are going to keep all out config files ,html code, roles and a playbook.</p><blockquote name="d9b7" id="d9b7" class="graf graf--blockquote graf-after--p">Note that as make a workspace as ws15 we need to change the host-file dir (/etc/ansible/hosts) to (/ws15)</blockquote><h4 name="6c8a" id="6c8a" class="graf graf--h4 graf-after--blockquote">Created the role my apache</h4><figure name="4dc4" id="4dc4" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*1Fzuvg1v82KEBpftPSsODQ.png" data-width="1275" data-height="868" src="https://cdn-images-1.medium.com/max/800/1*1Fzuvg1v82KEBpftPSsODQ.png"></figure><h4 name="f85b" id="f85b" class="graf graf--h4 graf-after--figure">Created role my-load-balancer</h4><figure name="93bf" id="93bf" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*tggtOlVV1EpTivCR2goQyA.png" data-width="1271" data-height="872" src="https://cdn-images-1.medium.com/max/800/1*tggtOlVV1EpTivCR2goQyA.png"></figure><h4 name="b6eb" id="b6eb" class="graf graf--h4 graf-after--figure"><strong class="markup--strong markup--h4-strong">Editing the role my-load-balancer and writing their our playbook</strong></h4><figure name="3b5b" id="3b5b" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*jJSYRLpiX-PUHmz-VyIqoQ.png" data-width="1269" data-height="862" src="https://cdn-images-1.medium.com/max/800/1*jJSYRLpiX-PUHmz-VyIqoQ.png"></figure><h4 name="6047" id="6047" class="graf graf--h4 graf-after--figure">Edited the role my-load-balancer</h4><figure name="d8e1" id="d8e1" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*r33i6Tnnm4YpTlD0gmXsGw.png" data-width="1274" data-height="870" src="https://cdn-images-1.medium.com/max/800/1*r33i6Tnnm4YpTlD0gmXsGw.png"></figure><h4 name="09ce" id="09ce" class="graf graf--h4 graf-after--figure">Editing the role my apache</h4><figure name="7a63" id="7a63" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*xaWsmLrG3jMJeom7VIRq7g.png" data-width="1272" data-height="873" src="https://cdn-images-1.medium.com/max/800/1*xaWsmLrG3jMJeom7VIRq7g.png"></figure><h4 name="38d3" id="38d3" class="graf graf--h4 graf-after--figure">Edited the role my apache</h4><figure name="4247" id="4247" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*GIqAt3olRBTcVosqukAg-A.png" data-width="1372" data-height="948" src="https://cdn-images-1.medium.com/max/800/1*GIqAt3olRBTcVosqukAg-A.png"></figure><h4 name="e53c" id="e53c" class="graf graf--h4 graf-after--figure">Copying the configuration file of haproxy</h4><p name="8858" id="8858" class="graf graf--p graf-after--h4">i.e haproxy.cfg in our workspace</p><figure name="853b" id="853b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wpJMe8BOV01WBvtnkD-kmg.png" data-width="1271" data-height="866" src="https://cdn-images-1.medium.com/max/800/1*wpJMe8BOV01WBvtnkD-kmg.png"></figure><h4 name="cd15" id="cd15" class="graf graf--h4 graf-after--figure">Editing the configuration file and making it dynamic so that when new slave node comes the playbook will be automatically updated and we don’t have to update it all the time.</h4><figure name="0824" id="0824" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*Q6i8XERMGue9VlhfMFCM_A.png" data-width="1274" data-height="871" src="https://cdn-images-1.medium.com/max/800/1*Q6i8XERMGue9VlhfMFCM_A.png"></figure><h4 name="26f8" id="26f8" class="graf graf--h4 graf-after--figure">Creating a basic webpage</h4><figure name="1c29" id="1c29" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*TB4mRXwC2EfYaABeDg64BA.png" data-width="1269" data-height="868" src="https://cdn-images-1.medium.com/max/800/1*TB4mRXwC2EfYaABeDg64BA.png"></figure><h4 name="2b30" id="2b30" class="graf graf--h4 graf-after--figure">Editing the webpage</h4><figure name="8986" id="8986" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*Fzm3ns7AW9B-mVh3xygT1Q.png" data-width="1268" data-height="875" src="https://cdn-images-1.medium.com/max/800/1*Fzm3ns7AW9B-mVh3xygT1Q.png"></figure><h4 name="d98a" id="d98a" class="graf graf--h4 graf-after--figure">Creaitng the playbook web.yml</h4><figure name="2729" id="2729" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*i0xVqS09OKhDD9M6zFBElQ.png" data-width="1266" data-height="883" src="https://cdn-images-1.medium.com/max/800/1*i0xVqS09OKhDD9M6zFBElQ.png"></figure><h4 name="f064" id="f064" class="graf graf--h4 graf-after--figure">Edited the playbook and added their our roles</h4><p name="b238" id="b238" class="graf graf--p graf-after--h4">This playbook does following things for us:</p><ul class="postList"><li name="1b7c" id="1b7c" class="graf graf--li graf-after--p">Creates a ansible role myapache to configure Httpd WebServer.</li><li name="ffd3" id="ffd3" class="graf graf--li graf-after--li">Creates another ansible role my-load-balancer to configure HAProxy LB.</li><li name="0698" id="0698" class="graf graf--li graf-after--li">Combines both of these roles controlling webserver versions <br> and solving challenge for host ip’s addition dynamically over each Managed Node in HAProxy.cfg file .</li></ul><figure name="ce98" id="ce98" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*JxQsh11-Ii8KW6FrsurJvA.png" data-width="1280" data-height="879" src="https://cdn-images-1.medium.com/max/800/1*JxQsh11-Ii8KW6FrsurJvA.png"></figure><h4 name="59ed" id="59ed" class="graf graf--h4 graf-after--figure">Checking the syntax of our playbook</h4><figure name="9d17" id="9d17" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*JTj50zk32m3DvNukIZ6ABg.png" data-width="1275" data-height="874" src="https://cdn-images-1.medium.com/max/800/1*JTj50zk32m3DvNukIZ6ABg.png"></figure><h4 name="64ef" id="64ef" class="graf graf--h4 graf-after--figure">Checking the connection to our slave</h4><figure name="811e" id="811e" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*M-zbMyde0CGQd-H0gPpX-A.png" data-width="634" data-height="442" src="https://cdn-images-1.medium.com/max/800/1*M-zbMyde0CGQd-H0gPpX-A.png"></figure><h4 name="c66e" id="c66e" class="graf graf--h4 graf-after--figure">Running our ansible playbook</h4><p name="6b62" id="6b62" class="graf graf--p graf-after--h4">checking in slave node if httpd is installed or not and disabled the firewall.</p><figure name="bdaf" id="bdaf" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*kErEVrPW7oGtXGKQhgq1nw.png" data-width="644" data-height="442" src="https://cdn-images-1.medium.com/max/800/1*kErEVrPW7oGtXGKQhgq1nw.png"></figure><figure name="3cdf" id="3cdf" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*gLHIYvqt3ToSCNG9CYiDXw.png" data-width="639" data-height="454" src="https://cdn-images-1.medium.com/max/800/1*gLHIYvqt3ToSCNG9CYiDXw.png"></figure><h4 name="5c9b" id="5c9b" class="graf graf--h4 graf-after--figure">We can see that the haproxy and httpd is installed and our load balancer is also configured</h4><figure name="c3ae" id="c3ae" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*Ln1IM2GWXF9MO7-oomSytA.png" data-width="1261" data-height="862" src="https://cdn-images-1.medium.com/max/800/1*Ln1IM2GWXF9MO7-oomSytA.png"></figure><h3 name="0472" id="0472" class="graf graf--h3 graf-after--figure">Conclusion</h3><p name="572d" id="572d" class="graf graf--p graf-after--h3 graf--trailing">In this task we learned the importance of haproxy and load balance as well as how to the configure of it using Ansible Playbook.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@tiybok45" class="p-author h-card">Rutvik Bhalerao</a> on <a href="https://medium.com/p/4e474cfe283d"><time class="dt-published" datetime="2021-04-05T11:59:05.000Z">April 5, 2021</time></a>.</p><p><a href="https://medium.com/@tiybok45/ansible-role-that-configures-load-balancer-and-a-web-server-using-ansible-4e474cfe283d" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 22, 2022.</p></footer></article></body></html>